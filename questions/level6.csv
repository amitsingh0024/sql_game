level,question_id,question_text,question_hint,question_answer,severity,unlock_status_xp_needed
6,L6_Q1,"In the Time Labyrinth, Zero notices that the most dangerous citizen in each region shifts over time. He must identify the current highest-threat citizen per region to stabilize temporal spikes.","Partition by region and rank within it.","SELECT name FROM (SELECT c.name, r.region_name, c.threat_level, RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS rk FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE rk = 1;","normal",0
6,L6_Q2,"Pixel detects that regions collapse when the second most dangerous citizen is almost as dangerous as the first. Zero must identify regions where this gap is dangerously small.","Compare ranks inside a partition.","SELECT region_name FROM (SELECT r.region_name, c.threat_level, RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS rk FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE rk IN (1,2) GROUP BY region_name HAVING MAX(threat_level) - MIN(threat_level) < 5;","normal",600
6,L6_Q3,"Time distortion increases when a citizen’s threat spikes compared to others in the same faction. Zero must find citizens whose threat level is in the top 10 percent of their faction.","Percentile reasoning using windows.","SELECT name FROM (SELECT c.name, c.threat_level, NTILE(10) OVER (PARTITION BY c.faction_id ORDER BY c.threat_level DESC) AS bucket FROM citizens c) x WHERE bucket = 1;","normal",1200
6,L6_Q4,"Nyx orders a running threat analysis to observe how cumulative danger grows within each region. Zero must compute cumulative threat per region ordered by age.","Running totals expose trends.","SELECT name FROM (SELECT c.name, r.region_name, SUM(c.threat_level) OVER (PARTITION BY r.id ORDER BY c.age) AS running_threat FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x;","normal",1800
6,L6_Q5,"Pixel finds that some regions appear stable only because their third most dangerous citizen is ignored. Zero must identify regions where the third highest threat exceeds safe limits.","Rank beyond the obvious.","SELECT region_name FROM (SELECT r.region_name, c.threat_level, DENSE_RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS rk FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE rk = 3 AND threat_level > 80;","normal",2400
6,L6_Q6,"Temporal echoes form when a citizen’s threat rises faster than others nearby. Zero must identify citizens whose threat jump is higher than the regional average jump.","Compare differences across ordered windows.","SELECT name FROM (SELECT c.name, r.region_name, c.threat_level - LAG(c.threat_level) OVER (PARTITION BY r.id ORDER BY c.age) AS delta FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE delta > (SELECT AVG(delta) FROM (SELECT c.threat_level - LAG(c.threat_level) OVER (PARTITION BY r.id ORDER BY c.age) AS delta FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) y WHERE delta IS NOT NULL);","normal",3000
6,L6_Q7,"Nyx wants to find citizens whose threat ranking within their faction is worse than their ranking within their region, indicating local instability.","Compare rank positions across dimensions.","SELECT name FROM (SELECT c.name, RANK() OVER (PARTITION BY c.faction_id ORDER BY c.threat_level DESC) AS faction_rank, RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS region_rank FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE region_rank < faction_rank;","normal",3600
6,L6_Q8,"Pixel detects that some factions slowly accumulate danger over time. Zero must compute rolling average threat over five oldest citizens per faction.","Moving window insight.","SELECT name FROM (SELECT c.name, AVG(c.threat_level) OVER (PARTITION BY c.faction_id ORDER BY c.age ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS rolling_avg FROM citizens c) x;","normal",4200
6,L6_Q9,"Time fractures when regions show inconsistent internal ordering. Zero must find regions where citizen age order does not match threat order.","Order comparison across windows.","SELECT region_name FROM (SELECT r.region_name, c.age, c.threat_level, ROW_NUMBER() OVER (PARTITION BY r.id ORDER BY c.age) AS age_pos, ROW_NUMBER() OVER (PARTITION BY r.id ORDER BY c.threat_level) AS threat_pos FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE age_pos <> threat_pos GROUP BY region_name;","normal",4800
6,L6_Q10,"Nyx demands a final stability snapshot listing only citizens whose threat level is above the regional median.","Median detection via window ranking.","SELECT name FROM (SELECT c.name, c.threat_level, r.region_name, NTILE(2) OVER (PARTITION BY r.id ORDER BY c.threat_level) AS half FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE half = 2;","normal",5400
6,L6_BOSS1,"BOSS FIGHT: The Time Warden hides by exploiting relative ordering. To weaken it, Zero must identify regions where the top two citizens together contribute more than half of the total regional threat.","Window sums plus filtering.","SELECT region_name FROM (SELECT r.region_name, c.threat_level, SUM(c.threat_level) OVER (PARTITION BY r.id) AS total_threat, RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS rk FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE rk <= 2 GROUP BY region_name, total_threat HAVING SUM(threat_level) > total_threat / 2;","boss",6200
6,L6_BOSS2,"FINAL BOSS: The Time Warden collapses timelines by hiding danger in ranked shadows. To destroy it, Zero must isolate citizens who are in the top 3 threats of their region, above the rolling regional average, and whose faction ranking worsens over time.","This is a full temporal reasoning test.","SELECT name FROM (SELECT c.name, r.region_name, c.threat_level, RANK() OVER (PARTITION BY r.id ORDER BY c.threat_level DESC) AS region_rank, AVG(c.threat_level) OVER (PARTITION BY r.id) AS region_avg, RANK() OVER (PARTITION BY c.faction_id ORDER BY c.age) AS faction_time_rank FROM citizens c JOIN addresses a ON c.address_id = a.id JOIN zones z ON a.zone_id = z.id JOIN regions r ON z.region_id = r.id) x WHERE region_rank <= 3 AND threat_level > region_avg AND faction_time_rank > 1;","boss",7000